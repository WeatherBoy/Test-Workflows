\section{Theory}\label{sec:theory}
\subsection{Fast Healthcare Interoperability Resources (FHIR)}
\subsubsection*{Health Level Seven and Background}
FHIR is a standard for healthcare data, designed with the intent of enabling secure digital exchange.
\\
Unlike most other products and industries, \emph{standards} thrive on monopoly. Monoculturalism is a widely debated topic and probably most commonly agreed upon as unhealthy or counterproductive in the grand scheme of things. In that sense, we, as humans and a collective, benefit from the development of multiple languages and cultures. However, when it comes to standards, especially something as critical as healthcare data, we all benefit from speaking exactly one language\footnote{One might be tempted to consult the XKCD comic of appendix \autoref{sec:XKCD-standards}.}. A singular language, one standard, enables seamless transfer of information between different institutions and even across country borders. This, in turn, permits third-party developers to more readily design software applications harnessing the statistical advantages associated with large quantities of standardised data. Furthermore, if everybody utilised one standard, these technological advancements could also propagate across institutions and national borders. Taking into account this strange tolerance of monopolies, in order to understand why FHIR is \textbf{the} standard, one must necessarily also get acquainted with the organisation developing it, Health Level Seven (HL7).
\\
FHIR was created and is currently maintained by the American non-profit organisation, HL7. It was founded in $1987$ by Donald W. Simborg with the original objective of developing a standard for the exchange of data within Hospital Information Systems\footnote{HIS is a somewhat broad term, describing the elements of health informatics which mainly focus on the administrative needs of hospitals. A HIS is a comprehensive integrated system, which has the intended function of managing all operational aspects of a hospital, i.e. medical, administrative, financial, legal and issues pertaining to the processing of services. HIS are also commonly referred to as Hospital Management Software or a Hospital Management System~\cite{Wiki-HIS}.} (HIS)~\cite{Wiki-HL7}. As of $2025$, today HL7's vision, as stated on their official website~\cite{HL7-about}, is:
\begin{center}
    \emph{"A world where every individual has secure, timely, and appropriate access to accurate health information, empowering them, their care teams, and communities to make informed decisions anytime, anywhere."}
\end{center}
As a testament to their vision, in September $2012$ HL7 announced their intention to license their standards at no cost, and finally in April $2013$ they made all their primary standards, alongside other select products, of which FHIR is a part, licensable at no cost~\cite{HL7-no-cost}. Furthermore, as an American-founded and American-based organisation, HL7 is accredited by the American National Standards Body (NSB) of the International Organisation for Standardisation (ISO), namely the American National Standards Institute (ANSI).
\\
As for the FHIR standard itself, in January $2018$, Apple announced that their \emph{Health App} on their iPhones would support a FHIR-compliant medical record~\cite{Apple-Health}. In $2020$, the United States Centres for Medicare \& Medicaid Services (CMS) issued a rule that required the use of FHIR by a slew of CMS-regulated payers. These were, amongst others, Medicare Advantage organisations, U.S. state Medicaid programmes and qualified health plans in the Federally Facilitated Marketplace~\cite{CMS-9115-F}. Also in $2020$, the "Minist\'{e}rio da Sa\'{u}de do Brasil" (The Brazilian Ministry of Health) announced the inception of one of the world's largest platforms for national health interoperability. The "Rede Nacional de Dados em Sa\'{u}de" (National Health Data Network) or RNDS, as it is called, uses HL7's FHIR r4 (fourth release\footnote{As of writing in September of $2025$, FHIR is at release five.}) for all its information exchanges~\cite{RNDS}.

\subsubsection*{FHIR technical details}
The FHIR standard is incredibly thorough, as one might expect for a standard intended for global digital exchange of healthcare data. As such, this theory section will first touch briefly on the core building blocks, then showcase an example, and finally give a brief overview of the underlying technical framework\footnote{I struggle with using the term \emph{architecture} here, as I fear it would seem to reference their backend, when in reality I intend to refer to the structural hiearchy upon which the FHIR standard is defined.}.
\\ 
All exchangeable information in FHIR is referred to as a \emph{Resource}. These can most commonly be thought of as \texttt{classes} as per Java syntax. From the official FHIR overview~\cite{FHIR-overview}, it is stated that all \emph{resources} share the following three characteristics:
\begin{itemize}
	\item There exists a common definition or representation. This representation is often made up of \texttt{Datatype}s (which we'll touch upon in further detail later on), which define some common reusable patterns.
	\item There is a common set of metadata. Some examples of which are, but not limited to:
	\begin{itemize}
		\item A \texttt{versionID} which changes each time the content (datatypes and definition) of the \emph{resource} is changed.
		\item  A \texttt{lastUpdated}, which is heavily linked to the aforementioned metadata. It tracks \textbf{when} there last was a change to the content of a \emph{resource}.
		\item A \texttt{source} which stores a Uniform Resource Identifier (URI) of another \emph{resource} instance or a perhaps more general identifier, which is intended to help illuminate the source for the information contained within the current \emph{resource}. 
	\end{itemize}
	\item There is a "human-readable" part, which, albeit, is an incredibly vague characteristic. In the FHIR documentation, it is called a \texttt{Narrative}. Which itself takes the shape of a \emph{resource}\footnote{Although this, at first glance, might seem like a circular definition (it at least had me fooled), the \texttt{Narrative} element is in fact a \texttt{special purpose datatype}. And \texttt{Datatype}s are very different from \emph{resources}, which we'll get back to in a little while.}, and is defined by containing an element called \texttt{div} of type \texttt{xhtml} (a specialised primitive datatype). If the \texttt{Narrative} element is flagged as 'non-empty', then its XHTML "SHALL reflect all content needed for a human to understand the essential clinical and business information for the \emph{resource}"~\cite{FHIR-Narrative}.
\end{itemize}

\noindent
Now, instead of meticulously going through every single \emph{resource} definition in FHIR, because, as can be seen in appendix \autoref{fig:FHIR-resource-index}, there are quite a lot, we'll briefly go over the \texttt{Patient} \emph{resource}.

\subsubsection*{The \texttt{Patient} resource}
The \texttt{Patient} \emph{resource} covers "information about an individual or animal receiving health care services"~\cite{FHIR-patient-resource}. An overview of the \texttt{Patient} \emph{resource} definition (anno 2025) from the official FHIR documentation can be seen in \autoref{fig:FHIR-patient-resource}. Here, the quick reader might note that, although we've just covered that \emph{resources} share three characteristics, one of which is that they service a "human-readable" part, the definition of the \texttt{Patient} \emph{resource} doesn't contain a \texttt{Narrative} element. This is because \texttt{Patient} \emph{extends} the \texttt{DomainResource} type, which in turn is defined by having a \texttt{text} element of type \texttt{narrative} (amongst other elements). An overview of the \texttt{DomainResource} \emph{superclass} can be seen in \autoref{fig:FHIR-DomainResource-resource}.

\begin{figure}[H]
    \centering
    \includegraphics[width=0.9\textwidth]{figures/theory/FHIR-DomainResource-resource.png}
    \caption{FHIR \texttt{DomainResource} \emph{resource}}
    \medskip
    \small
    \raggedright
    FHIR's \texttt{DomainResource} \emph{resource}. It can be found at ~\cite{FHIR-DomainResource-resource}.
    \label{fig:FHIR-DomainResource-resource}
\end{figure}

\noindent
However, the \texttt{Patient} definition in itself contains a wide array of elements. 16 in total, discounting sub-elements of \texttt{BackboneElement}s. To mention a few, there is the very useful \emph{boolean} \texttt{active}, which indicates whether the patient's record is being actively used. Similarly, but still distinct, is the \texttt{deceased} element, which contains two elements of \texttt{PrimitiveType}. A \emph{boolean} and a \emph{dateTime}, if the \emph{boolean} is set to true, indicating the time of decease. Additionally, \texttt{Patient} contains elements pertaining to the available methods of communication for the actual patient, in spoken as well as nonverbal language, and their preferred method of communication. Also, the \texttt{contact} \texttt{BackboneElement}, which details the contact information for a contact of the patient, intuitively, since it has a cardinality of $0..^\ast$ (as shown in the \textbf{Card.} column in \autoref{fig:FHIR-patient-resource}), a single \texttt{Patient} instance can contain multiple \texttt{contact}s.

\begin{figure}[H]
    \centering
    \includegraphics[width=0.95\textwidth]{figures/theory/FHIR-patient-resource.png}
    \caption{FHIR \texttt{Patient} \emph{resource}}
    \medskip
    \small
    \raggedright
    FHIR's \texttt{Patient} \emph{resource}. It can be found at ~\cite{FHIR-patient-resource}.
    \label{fig:FHIR-patient-resource}
\end{figure}

\subsubsection*{Cardinality and Flags}
On the topic of cardinality, FHIR supports four different types of cardinalities for elements within \emph{resource} definitions. Namely,
\begin{itemize}
    \item $0..1$: zero or one element,
    \item $0..^\ast$: zero or more elements,
    \item $1..1$: exactly one element,
    \item $1..^\ast$: at least one or more elements.
\end{itemize}

\noindent
In addition to cardinality, FHIR supports quite a handful of flags, as can be seen in the \textbf{Flags} column of \autoref{fig:FHIR-patient-resource}. There are flags as simple as \texttt{summary}, given by a capital Greek sigma, $\Sigma$, indicating that the flagged element is important enough to be a part of the summary for its parent \emph{resource}. The summary flag is intended to make search results more manageable. There are, however, also flags such as the \texttt{is-modifier}, given by a question mark followed by an exclamation mark $?!$. This flag is kind of a 'warning label', saying that the value of the element flagged with \texttt{is-modifier} will change the meaning of the rest of the parent \emph{resource}. For \texttt{Patient}, it makes perfect sense that the \texttt{deceased} element is flagged with \texttt{is-modifier}. Another way to understand \texttt{is-modifier} is the example given in the documentation~\cite{FHIR-isModifier-flag}. The \texttt{Observation} \texttt{DomainResource} is intended to cover measurements and simple observations. However, it has an element, \texttt{status}, of type \texttt{code} which is flagged with \texttt{is-modifier}. The \texttt{code} \texttt{primitive type} indicates that the element can only take the value of a set of predefined \emph{strings}. For \texttt{Observation.status}, one of those predefined \emph{strings} was "\emph{entered-in-error}", which would null the entire \texttt{Observation} instance. So, although the existence of an instance of type \texttt{Observation} would indicate to a user that there in fact had been such an 'observation', the \texttt{status} element might have completely nullified that preconception. 
\\
There are a few other flags\footnote{All the different types of flags are: \texttt{is-modifier}, \texttt{mustSupport}, \texttt{summary}, \texttt{constraint}, \texttt{noExtensions} and then three describing 'versions': \texttt{trialUse}, \texttt{normative} and \texttt{draft}. They are all described in-depth in the documentation ~\cite{FHIR-flags-overview}.}; however, we will be moving on to the underlying technical framework of FHIR.

\subsubsection*{FHIR \texttt{Type} Framework}
Having disclosed the main building blocks, a \emph{resource}, and an example, \texttt{Patient}, it is time to take a look at the underlying data hierarchy. As briefly alluded to earlier, there are a bunch of different data types in FHIR, and although the \emph{resource} is still "queen of the ball", there has been some additional thought poured into the FHIR standard.

\begin{figure}[H]
    \centering
    \includegraphics[width=0.95\textwidth]{figures/theory/FHIR-Type-Framework.png}
    \caption{FHIR \texttt{Type} \emph{framework}}
    \medskip
    \small
    \raggedright
    FHIR's \texttt{Type} \emph{framework}. It can be found at ~\cite{FHIR-type-framework}.
    \label{fig:FHIR-Type-Framework}
\end{figure}

\noindent
\autoref{fig:FHIR-Type-Framework} gives a good overview of the framework, and from it, we can see that all types inherit from the same base type, \texttt{Base}. Yet, there are two main branches.

\subsubsection*{\emph{Resource} Types}
There are three non-\texttt{DomainResource} \emph{resources}, they are \texttt{Bundle}, \texttt{Parameters} and \texttt{Binary}. All three are very high-level and tied to FHIR's underlying functionality and definitions. Most importantly and applicable for all three, though, is that none of them adhere to the previously addressed \emph{resource} definition. FHIR isn't designed with the intent of purposefully pulling up an instance of \texttt{Binary} as one would an instance of \texttt{Observation} or \texttt{Patient}.
\\
In turn, the \texttt{DomainResource} are the aforementioned \emph{resources}. These are designed to cover real-world medical tangibles, such as a patient journal or an observation made by a healthcare professional. 
\\
The two, \texttt{CanonicalResource} and \texttt{MetadataResource}, are further levels of specification. Mentioning these and starting to list examples would be way too specific for the scope of this report.

\subsubsection*{\emph{Element} Types}
The \emph{Element} types split into two main categories, the \texttt{DataType}s and \texttt{BackboneElement}s. We have already briefly touched upon \texttt{BackboneElement} types in the closer look at the \texttt{Patient} \emph{resource}. \texttt{BackboneElement}s are tied to their parent \emph{resource}, as it were for the \texttt{Patient.contact} element. In other words, elements of type \texttt{BackboneElement} don't necessarily appear in any other \emph{resources} than their parent \emph{resource}. In turn, this allows for the creation of flexible "lists", so to speak, which can contain multiple different elements of varying types.
\\
As for the \texttt{DataType} type, it seems somewhat like a catch-all, but maybe more accurately a type for all the common subtypes of elements of actual \emph{resources}. The list of \texttt{DataType}s is myriad, and in appendix \autoref{fig:FHIR-data-types-overview}, an overview is provided.
\\

\begin{figure}[H]
    \centering
    \includegraphics[width=0.95\textwidth]{figures/theory/FHIR-Primitive-Types.png}
    \caption{FHIR \texttt{PrimitiveType}s overview}
    \medskip
    \small
    \raggedright
    An overview of FHIR's \texttt{PrimitiveType}s. It can be found at ~\cite{FHIR-data-types-overview}.
    \label{fig:FHIR-Primitive-Types}
\end{figure}

\noindent
We will refrain from delving deeper into the \texttt{BackboneType}, so finally, there are the \texttt{PrimitiveTypes}. These are, in large part, the common types one would be familiar with as a programmer. They are \texttt{string}, \texttt{base64Binary}, \texttt{unsignedInt}, \texttt{boolean} and so on. However, there are also a few additional ones, like \texttt{code}, which we have already mentioned and which designates a set of predefined \emph{strings} to choose from. \texttt{markdown} is simply a field which allows for \emph{Markdown} formatted text. And \texttt{URI} is a \emph{Unique Resource Identifier}, an ID of sorts.

\subsection{Questionnaires}
For this report, I have used eight questionnaires to detail relevant information tied to a given diabetes patient. They are all the same questionnaires as used in the DiaFocus project ~\cite{DiaFocus}, and in the following, their credentials will be described in brief. 

\subsubsection*{B1 - Life Style Information}
B1 - Life Style Information was used to collect lifestyle information and to assess the psycho-social status and self-care motivation regarding the patient. For the DiaFocus project, they used a slightly altered version of the Accu-Chek Interview Questionnaire ~\cite{Accu-Chek}. The B1 instrument can be seen in appendix \autoref{sec:B1-life-style}.

\subsubsection*{B2 - Emotional Distress}
B2 - Emotional Distress was used to measure, well, the emotional distress of the patient. The B2 instrument was designed and validated specifically for the DiaFocus project~\cite{DiaFocus}. The instrument can be seen in appendix \autoref{sec:B2-emotional-distress}.

\subsubsection*{C - Areas of Concern}
This questionnaire is also quite self-explanatory, it was used to pinpoint areas of concern for the patient with regard to their diabetes. The listed areas of concern were compiled based on input from both healthcare professionals and patients involved in the DiaFocus project~\cite{DiaFocus}. The instrument can be seen in appendix \autoref{sec:C-areas-of-concern}.

\subsubsection*{D1 - Food Behavior}
This questionnaire was designed to pinpoint the patients' eating habits tied to their diabetes. 'Food Behaviour' might be a better way to phrase it, seeing as this mostly concerns whether the patient is able to stick to a healthy dietary plan or whether anything in their life prohibits them from reaching this goal. The instrument was developed specifically for the DiaFocus project~\cite{DiaFocus} by clinicians from Steno Diabetes Center Copenhagen and Copenhagen Center for Diabetes. The instrument can be seen in appendix \autoref{sec:D1-food-behavior}.

\subsubsection*{D4 - Danish Medication Adherence Scale (DMAS)}
This was by far the weirdest of the questionnaires utilised for this report. It was entirely unclear how this instrument works.
\\
For this report, I've used the questions as presented in the DiaFocus project~\cite{DiaFocus}; however, in the DiaFocus article, they cite a Danish report and a website, "cachet - Copenhagen Center for Health Technology". From the website, it is stated: "Internationally, the Morisky Medication Adherence Scale (MMAS) is often used."~\cite{cachet-CCHT}. Then, they go on to explain that the MMAS is neither translated nor validated in Danish; as such, it can't be used in a Danish setting. Nevertheless, there exists the Danish Medicine Adherence (MA) scale, which, although not published, is available in a report from "Region Midt"~\cite{Danish-Medicine-Adherence-Scale} - the aforementioned Danish report.
\\
The questions used in this report, which originate from the DiaFocus project, are thus an unofficial English translation of a Danish instrument, inspired by an American medicine adherence scale, the MMAs.
\\
The instrument can be seen in appendix \autoref{sec:D4-danish-medication-adherence}.

\subsubsection*{Wellbeing - WHO-5}
Although the WHO-5 is pulled from the DiaFocus project, all the same, it is nevertheless a widely used questionnaire to assess the subjective psychological well-being of patients. It was developed by the World Health Organisation and has been validated in multiple studies~\cite{WHO5}. The instrument can be seen in appendix \autoref{sec:who-5}.

\subsubsection*{Pittsburg Sleep Quality Index (PSQI)}
The PSQI is also a widely used questionnaire. It is intendedÂ to assess sleep quality and patterns. It was developed by Buysse et al.~\cite{PSQI} at the University of Pittsburgh. The instrument can be seen in appendix \autoref{sec:psqi}.

\subsubsection*{Hospital Depression and Anxiety Scale (HADS)}
Finally, the HADS is also a well-recognised and widely utilised questionnaire to assess anxiety and depression. It was developed by Zigmond et al.~\cite{HADS}. The instrument can be seen in appendix \autoref{sec:hads}.


